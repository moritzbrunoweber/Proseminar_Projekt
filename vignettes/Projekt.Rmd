---
title: "How Changes in Tree Cover in the Amazon Rain Forest correlate with a Change in Terrestrial Water Storage"
author: "Moritz Weber"
date: "18 Dezember 2025"
output: html_document
---

```{r message=FALSE, warning=FALSE}
library(ncdf4)
library(purrr)
library(terra)
library(here)
library(ggplot2)
library(sf)
library(rnaturalearth)
library(rnaturalearthdata)
library(dplyr)
```

## Introduction
The Amazon rain forest plays a vital role in the earth's climate system and global water cycle. It acts as a big carbon sink and contributes significantly to regional and global precipitation patterns through evapotranspiration. However, widespread deforestation driven by agriculture, logging, and urbanization threaten the Amazon rain forest. Changes in forest cover can disrupt water storage and availability, affecting surface water, soil moisture, and groundwater dynamics. By analyzing terrestrial water storage anomalies from GRACE/GRACE-FO data in relation to deforestation areas, I want to see if there is a quantifiable correlation between the two. In order to get a most complete picture of the situation, a relatively large area of interest is chosen: 

```{r}
knitr::include_graphics(
  here("fig", "area_of_interest.png")
)
```

## Methods and Data
There are two data sets being used for this project, the first one being "COST-G GravIS RL02 Terrestrial Water Storage Anomalies". The GRACE-FO satellites, which have been in orbit since 2002, gather data about earth's gravitational anomalies. In this specific data set, the collected data is processed to terrestrial water storage anomalies relative to the long term mean of April 2002 - March 2020, provided in cm of equivalent water height at a rather big pixel size of 1Â° latitude/longitude and a monthly temporal resolution.
The second data set is the tree cover product, provided by MODIS/Terra Vegetation. Its pixel size is very small with 250 by 250 meters and it has a yearly temporal resolution.

The aim of this project is to relate the change in the yearly amplitude of terrestrial water storage anomaly for the longest possible period, April 2002 - May 2025, to the change in tree cover from the measuring period March 2000 - March 2001 to the measuring period March 2024 - March 2025.
The hypothesis which is being researched is as follows: for areas with declined tree cover, the trend in the amplitude of TWS storage will decline, as there is less vegetation surface for evapotranspiration to take place, lowering the maximum water storage - similar to the well known principle "Schwammstadt" in urban geography.

The first part of data processing handles the GRACE-FO data on terrestrial water storage. The monthly data is grouped by years, the cut-off date being July 1st (for a clear yearly amplitude), and the yearly amplitude extracted. Now, with this time series of yearly TWS amplitudes for the period April 2002 - May 2025, for every spatial data point a linear regression is made to calculate the trend of TWS for said period. The result is a raster showing the yearly change in TWS in centimeter water height equivalent.

```{r}
knitr::include_graphics(
  here("fig", "trend_amplitude_tws.png")
)
```

The second part of data processing concerns the change in tree cover. From the downloaded .hdf files, which include multiple layers with vegetation related data, the layers containing the tree cover data need to be extracted, mosaiced together and then masked with the area of interest, which results in two rasters displaying the amount of tree covered area in percent for the periods of March 2000 - March 2001 and March 2024 - March 2025.

```{r}
knitr::include_graphics(
  here("fig", "tree_cover_2000.png")
)
knitr::include_graphics(
  here("fig", "tree_cover_2024.png")
)
```

For further data processing and better visual understanding, the two rasters are subtracted from one another, resulting in the change in tree cover over the 24 year period, displayed in percent.

```{r}
knitr::include_graphics(
  here("fig", "tree_cover_change_original.png")
)
```

For statistical analysis, the tree cover change raster's spatial resolution needs to be adapted to the much lower spatial resolution of the TWS raster, which looks as follows:

```{r}
knitr::include_graphics(
  here("fig", "tree_cover_change_resampled.png")
)
```

3. Results: Reports the results in a logical order that facilitates reading - from the general pattern to the details. Basic and central finding first, then the nuance.
4. Discussion: Explain what the results mean in relation to the question stated in the Introduction. Discuss caveats, compare to earlier findings, and explain the relevance of your results.

